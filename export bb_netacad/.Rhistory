library(readr)
library(dplyr)
library(tidyr)
# read configuration file
# read slist filename from the configuration file and remove NAs
#temp_slist = config$slist_filename %>% na.omit()
# Load student list downloaded in the .csv format from the Blackboard
slist = read_csv(file = 'COMP1232_Student_List_2018-03-12-18.csv',col_names=c('Student ID','FN','LN','Email','Role','temp1','temp2','CRN'))
slist = separate(slist,'Student ID',into=c('Student ID'),sep='\\ ',extra='drop')
# Select all rows where role is student
slist = slist %>% filter(Role=='Student',!is.na(CRN)) %>% select(`Student ID`,FN,LN,Email)
# Change Email column to lower case
slist$Email = tolower(slist$Email)
# Find preview user from the slist if present and remove it
if (length(grep(pattern = 'previewuser',slist$`Student ID`))>0) {
slist = slist[-grep(pattern = 'previewuser',slist$`Student ID`),]
}
###################
bb_grades = read_csv('gc_XLIST_Kara_COMP1232_201702_fullgc_2018-03-12-18-20-49.csv')
bb_grades = bb_grades %>% select(Username,`Mid-Term [Total Pts: 50 Score] |926205`) %>% rename('Student ID' = Username)
bb_grades$`Student ID` = as.character(bb_grades$`Student ID`)
bb_grades= slist %>% left_join(bb_grades)
bb_grades$`Mid-Term [Total Pts: 50 Score] |926205` = as.double(bb_grades$`Mid-Term [Total Pts: 50 Score] |926205`)
bb_grades[is.na(bb_grades)]=0
bb_grades = bb_grades %>% mutate(midterm = (`Mid-Term [Total Pts: 50 Score] |926205`/50)*30)
bb_grades$midterm = round(bb_grades$midterm,2)
bb_grades = bb_grades %>% select(Email,midterm)
bb_grades = bb_grades %>% rename('SIS Login ID' = Email)
######################
netacad_grades = read_csv('netacad_grades.csv',col_types = cols(.default = 'd', Student = 'c','SIS Login ID' = 'c'))
netacad_grades$`SIS Login ID` = tolower(netacad_grades$`SIS Login ID`)
netacad_grades = netacad_grades %>% filter(!is.na(ID))
if (length(grep(pattern = 'Test Student',netacad_grades$Student))>0) {
netacad_grades = netacad_grades[-grep(pattern = 'Test Student',netacad_grades$Student),]
}
netacad_grades = netacad_grades %>% left_join(bb_grades)
write_csv(netacad_grades,'netacad_grades_merge.csv')
netacad= read_csv('netacad_grades.csv',col_types = cols(.default = 'd', Student = 'c','SIS Login ID' = 'c'))
View(netacad)
View(netacad_grades)
t1 = netacad_grades$midterm
length(t1)
nrow(netacad_grades)
sum(is.na(t1))
length(is.na(t1))
t2 = netacad$`Midterm 1232 (out of 30) Current Score`
class(t1)
t1
t1[is.na(t1)]=0
t1
t2
t2[is.na(t2)]=0
t1
t1>t2
t1
t1 > 0
is(t1>t2)
t1>>t2
t1
which(t1>0)
which(t1>t2)
nrow(t1)
length(t1)
length(t2)
t1+t2
t1>t2
which(t1>t2)
index = which(t1>t2)
index
test = netacad_grades[index,]
View(test)
rm(test)
netacad_grades[index,]
0/0
t2
12/0
0/0
